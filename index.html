<html>
<head>
    <title>Leaflet</title>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
<script type='text/javascript' src="Marker.Text.js"></script>
    <style type="text/css">
        .label {
            margin-top: 0px !important;
            font-size: 10px !important;

        }
    </style>
<script src="hull.js"></script>    
</head>
<body>
    <div style="width:100%; height:100%" id="map"></div>

<script type='text/javascript'>

var map = L.map('map');
map.addLayer(new L.TileLayer('http://{s}.tiles.mapbox.com/v3/dennisl.map-dfbkqsr2/{z}/{x}/{y}.png'));

var DEBUG = true;
var DEBUG1 = true;
function JSONP(obj){
    var points = obj.points;
    console.log(points.length + " points.");
    var pts = [];
    for(var i = 0; i < points.length; i++){
        var p = new L.latLng(points[i]);
        p.name = ''+i;
        p.x = p.lng;
        p.y = p.lat2y();
        pts.push(p);
    }

    for(i = 0; i < pts.length; i ++){
        var rr = L.circleMarker(pts[i], {title: pts[i].name, color:"#000", radius:2, fillOpacity:1})
                .addTo(map);
        var myIcon = L.divIcon({className:'label', html:''+pts[i].name });//+ '('+pts[i].x+', '+pts[i].y+')'});
        L.marker(pts[i], {icon: myIcon}).addTo(map);

    }
    map.fitBounds(pts);
    var hull = pts.concaveHull(120);
    var hullP = L.polygon(hull, {color: '#00F', fillColor: '#00F', fillOpacity: 0.5, weight: 1});
    console.log(hull.length + " points in hull.");
    hullP.addTo(map);
}

</script>

<script type='text/javascript' src="data50.js"></script>

</body>


</html>

